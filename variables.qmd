---
output: html_document
editor_options: 
  chunk_output_type: console
---
# Variables

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE,
                      message = FALSE)
library(pacman)
p_load(tidyverse, readxl, janitor, foreign, haven, knitr)
wvs <- read_csv("../../DataIP/Datasets/wvs7_example.csv")
mid <- read_csv("../../DataIP/Datasets/dyadic_mid_4.02.csv")
```




## Variables de ràtio{#ratio} 

A diferència de les altres variables que hem vist, les **variables numèriques de ràtio** (o simplement, **variables de ràtio**) tenen totes les propietats matemàtiques. Podem dir si els nombres són iguals o diferents, si són més grans o més petits, quina distància hi ha entre ells i també podem saber la quantitat relativa de cada valor. La propietat distintiva de les variables de ràtio és que el zero té significat. Això vol dir que hi ha un punt de referència que marca l’absència del fenomen. El zero en l'edat d'una persona significa absència d'anys, així com el zero en la taxa d'atur significa l'absència d'atur i el zero en població significa que aquell país o territori no té població.

::: {.column-margin}
::: {.callout-note}
## Què vol dir 1.2e+07?
Quan tractem amb variables numèriques, sovint veurem els valors representats amb notació científica:

```{r collapse=T, echo = T, eval = T}
12000000
```

Interpretar-los és més fàcil del que sembla, ja que simplement hem de moure
els decimals tantes vegades a la dreta com ens indiqui l’últim nombre, si és positiu,
o tantes vegades a l’esquerra si és negatiu. Per exemple, 2.50+e08 es traduirà com a 250.000.000.
:::
:::

El fet que el zero tingui significat ens permet utilitzar-lo per establir relacions entre els valors de la variable a través d'operacions matemàtiques més complexes, com multiplicar, dividir, fer arrels quadrades, etc. Per exemple, podem dir que deu anys d'edat són el doble que cinc, o que si l'atur varia del 10% al 5%, s'ha reduït a la meitat. Aquestes són operacions que no podem fer amb els altres tipus de variables que hem vist. Per exemple, amb l'escala d'interval de Polity V no podem dir que un país és el doble de democràtic que un altre. Ni tampoc podem dir que un país categoritzat com a "Low Income" sigui la meitat que "Lower Middle Income". Això és degut a que el zero, que és un punt real de referència en les variables de ràtio, no existeix ni té significat propi en les altres variables. Des d'un punt de vista de l'anàlisi quantitativa, doncs, les variables de ràtio són preferibles als altres tipus de variables perquè permeten fer més operacions matemàtiques.

A R, emmagatzemarem les variables de ràtio com a **vectors numèrics**. Algunes d'elles també les podríem emmagatzemar com a vectors enters. 


### Operacions amb variables de ràtio

Per fer algunes operacions amb variables de ràtio, hem recreat les capacitats materials de les principals potències participants a la Segona Guerra Mundial l'any 1939 a partir de les dades de la [National Material Capabilities (NMC)](https://correlatesofwar.org/data-sets/national-material-capabilities){target="_blank"} dataset [@Singer1987; @Singer1972]. El marc de dades  `ratios` conté la variable despesa militar (`milex`, en milers de dòlars), personal militar (`milper`, en milers), total de població (`tpop`, en milers), i l'índex CINC (`cinc`)^[Respon a l'acrònim Composite Index of National Capability. La variable `milex` respon a la despesa militar, `milper` a personal militar i `tpop` a població total. Aquestes i altres variables formen l'índex `cinc`.], que és una mesura composta que classifica els països segons les seves capacitats materials.

```{r collapse = T}
#| column: body-outset
ratio <- tibble(country = c("USA", "UKG", "FRN", "GMY", "ITA", "RUS", "JPN"),
                milex = c(980000, 7895671, 1023651, 12000000, 669412, 5984123, 1699970),
                milper = c(334, 394, 581, 2750, 581, 1789, 957),
                tpop = c(131028, 47762, 41900, 79798, 44020, 170317, 71380),
                cinc = c(0.182, 0.0997, 0.0396, 0.178, 0.0270, 0.138, 0.0591))
ratio
```

Amb les operacions que veiem al requadre lateral, podem respondre preguntes com les que fem a continuació:

::: {.column-margin}
::: {.callout-note}
## Operacions
Amb les variables de ràtio podem fer operacions de:

- Igualtat (`==`, `%in%`)
- No igualtat (`!=`)
- Més gran que (`>`)
- Més gran o igual que (`>=`)
- Més petit que (`<`)
- Més petit o igual que (`<=`)
- Sumes (`+`), restes (`-`), multiplicacions (`*`), divisions (`/`)
- Altres tipus d'operacions com arrels quadrades (`sqrt()`), logaritmes (`log()`), màxims (`max()`), el mínims (`min()`) o mitjanes (`mean()`).  
:::
:::

::: {.panel-tabset}
## Personal militar
Quin país té més un personal militar superior al milió de persones?

```{r collapse = T}
ratio$country[ratio$milper > 1000]
```

## Despesa militar
Quantes vegades la despesa militar d'Alemanya és superior cada una de les altres potències?

```{r collapse = T}
ratio$milex_gmy <- ratio$milex[ratio$country == "GMY"] / ratio$milex
ratio
```

## Percentatges
Quin país té un personal militar inferior al 1 per cent de la població?

```{r collapse = T}
ratio$country[1 > ratio$milper / ratio$tpop * 100]
```

## Màxims
Quin és el país amb l'índex CINC més alt?

```{r collapse = T}
ratio$country[ratio$cinc == max(ratio$cinc)]
```

## Mínims
Quin és el país amb menys despesa militar?

```{r collapse = T}
ratio$country[ratio$milex == min(ratio$milex)]
```
:::

### Importar variables de ràtio

Les variables de ràtio s'acostumen a importar automàticament com a vectors numèrics, que és el que necessitem per poder fer operacions de tot tipus. No obstant, convé saber distingir entre tres tipus (o ordres) de variables de ràtio: els recomptes, els ràtios i els índexs compostos [@Power1999; @Merry2016, p. 15]. Aquests tipus de variables els trobem representats a la següent taula @tbl-nuts, que inclou dades d'Eurostat i dades de vot a partits regionalistes i independentistes en diverses regions europees [@Sanjaume2023]. 

```{r echo = F}
#| label: tbl-nuts
#| tbl-cap: NUTS dataset
#| column: page-right
nuts <- tibble(read_csv("../../Old/NUTS_datset/euromap.csv")) |> 
  filter(!is.na(vote_year)) |> 
  select(id, country, nuts_name, 
         vote_reg:vote_ind, gdpc, innov, pop:distance)
nuts |> 
  head(10) |> 
  knitr::kable()
```

Les dades de **recompte** són dades que compten coses, com la població (`pop`) o la superfície del territori (`area`). Per definició no cal que tinguin decimals. Les dades de **ràtio** comparen dos nombres, com el percentatge de vot (`vote_reg`, que divideix votants a partits regionalistes pel total de votants), la densitat de població (`density`, compara habitants i àrea) o el PIB per càpita (`gdpc`, estableix la mitjana d'ingressos per habitant). És molt probable que tinguin decimals. Finalment, els **índexs** són mesures més complexes que agrupen vàries variables, com l'[Índex d'Innovació Regional](https://research-and-innovation.ec.europa.eu/statistics/performance-indicators/regional-innovation-scoreboard_en){target="_blank"} (`innov`)^[Per saber-ne més, veure el mòdul docent [Mesures compostes](https://www.jordimas.cat/courses/fiiei_cat/indicadors/){target="_blank"}.]. 

:::{.column-margin}
::: {.callout-caution collapse="true"}
## On més hem vist variables de ràtio?
En aquest capítol, també hem vist anteriorment en bases de dades exemples de variables de ràtio. Per exemple:

- La durada d'una disputa militar militaritzada (`duration`) a la taula @tbl-mid.
- Els mesos d'un líder polític al càrrec (`tenure_months`) a la taula @tbl-reign.
- La mida relativa d'un grup ètnic a dins d'un país (`size`) a la taula @tbl-epr.
:::
:::

::: {.callout-tip appearance="minimal"}
::: {#exr-ratio}
## Variables de ràtio
Practica les variables de ràtio amb els exercicis d'[aquesta web](https://www.jordimas.cat/courses/dataanalysis_en/exercises/data_analysis_en_exercises_beginner#ratio/){target="_blank"}.
:::
:::


