---
title: "Ecological fallacy"
format: html
---

## EF

Quan la unitat d’anàlisi i la unitat d’observació no coincideixen, tenim el risc d’incórrer en un problema habitual d’inferència que se’n diu fal·làcia ecològica. Aquesta situació es produeix perquè volem dir alguna cosa sobre una població de la qual, per diverses raons, només disposem de dades agregades (Achen and Shively). Ho veurem més clar amb un exemple. 

Suposem que volem fer un estudi de la relació entre la religió i el suicidi. La nostra unitat d'anàlisi és l'individu perquè volem saber per què les persones es suiciden més que altres. Malauradament, no disposem de dades individuals, sinó agregades a nivell de departament. La XXX mostra les dades del departament d'Isère (França) per cada grup religiós, que serà la nostra unitat d'observació. Observem que hi ha més suicidi entre protestants que entre catòlics.

```{r echo = F, message=F, warning=F}
library(dplyr)
suicide <- tibble(region = c("Isère"),
                  municipality = rep(c("Grenoble", "Le Bourg-d'Oisans", "Saint-Jean-de-Maurienne"), times = 1, each = 2),
                  religion = rep(c("Protestant", "Catholic"), times = 3),
                  population = c(8250,1080,325,593,181,392),
                  suicide = c(520, 72, 12, 20, 5, 11))
suicide |> 
  group_by(religion) |> 
  summarize(population = sum(population),
            suicide = sum(suicide)) |> 
  mutate(perc = suicide / population * 100)
```

Amb les dades que tenim, podríem concloure que els individus que practiquen la religió protestant se suiciden més que els que practiquen la religió catòlica. Però el cert és que, amb la informació que tenim, no ho podem saber del cert. Hem de tenir present que podem incórrer en un problema de fal·làcia ecològica perquè estem arribant a una conclusió sobre una unitat d'anàlisi (l'individu) amb dades agregades d'un nivell superior (departament).

Vegem què podria passar si, quan desagreguem les dades a nivell de municipi, ens trobem que passa just al contrari. La XX desagrega les dades del departament d'Isère per tres municipis: Grenoble, Le Bourg-d'Oisans i Saint-Jean-de-Maurienne. Ara la unitat d'observació és el municipi per grup religiós. 

```{r}
#But when we disaggregate the data ...
suicide |> 
  mutate(perc = suicide / population * 100) |>
  arrange(desc(perc))
```

Amb les dades desagregades, observem que les taxes de suicidi són molt semblants entre catòlics i protestants. De fet, en dos dels tres municipis els catòlics tenen una taxa de suicidi més alta. Què ha passat? Doncs que a Grenoble, on hi ha una taxa de suicidi més alta, hi ha més practicants de la religió protestant. En canvi, als municipis petits, amb taxes de suicidi més baixes, hi ha més practicants de la religió catòlica. Això fa que, quan agreguem les dades a nivell de departament, no puguem observar l'efecte que té el municipi. 

En resum, el que és cert a nivell agregat no és necessàriament cert a nivell individual. Si trobem una relació entre característiques de grup això no significa que la relació existeixi entre les característiques dels individus del grup.
